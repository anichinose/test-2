import React, { useEffect, useMemo, useRef, useState } from "react";

/* =============================================
   è‹±æ¤œèªå½™å•é¡Œï¼ˆSet1ã€œ10 + REVIEWï¼‰ React å®Œå…¨ç‰ˆ
   - Set1ã€œ3: æ‰‹æ›¸ã22å•
   - Set4ã€œ10: å“è©ãƒ†ãƒ³ãƒ—ãƒ¬ + å…¨æ–‡å’Œè¨³ã‚’è‡ªå‹•ç”Ÿæˆï¼ˆ22å•ï¼‰
   - REVIEW: èª¤ç­”ã‚’localStorageã«ä¿å­˜ã—ã¦å¾©ç¿’
   - ã‚¯ãƒªãƒƒã‚¯ã§ï¼šæ­£ç­”ã‚’ç©ºæ‰€ã«æŒ¿å…¥ï¼é¸æŠè‚¢ã¸å’Œè¨³ä»˜ä¸ï¼æ–‡ã®å’Œè¨³ã‚’è¡¨ç¤º
   - é¸æŠè‚¢ã¯æ¯å•ã‚·ãƒ£ãƒƒãƒ•ãƒ«
   - Homeãƒœã‚¿ãƒ³å¸¸æ™‚è¡¨ç¤ºã€Perfect! ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
============================================= */

/* ====== æ°¸ç¶šåŒ– ====== */
const STORAGE_KEY = "eiken_vocab_wrong_v1";
const loadWrong = () => {
  try { return new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]")); }
  catch { return new Set(); }
};
const saveWrong = (s) => { try { localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(s))); } catch {} };
const addWrong = (t) => { const s = loadWrong(); s.add(t); saveWrong(s); };
const removeWrong = (t) => { const s = loadWrong(); if (s.delete(t)) saveWrong(s); };
const clearWrong = () => { try { localStorage.removeItem(STORAGE_KEY); } catch {} };

/* ====== Utils ====== */
const BLANK_HTML = '(<span class="gap empty" aria-live="polite">&nbsp;</span>)';
const shuffle = (arr) => { const a = arr.slice(); for (let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; };
const formatTime = (ms) => { const s=Math.floor(ms/1000), m=Math.floor(s/60); return `${m}:${String(s%60).padStart(2,'0')}`; };

/* ====== ã‚¹ã‚¿ã‚¤ãƒ« ====== */
const GlobalStyle = () => (
  <style>{`
    :root{ --accent-green:#14532d; --accent-gold:#d4af37; }
    html,body,#root{ height:100%; }
    body{ margin:0; font-family:Arial, sans-serif; }
    .app-bg{ min-height:100vh; background:url('https://images.unsplash.com/photo-1508264165352-258859e62245?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80') no-repeat center/cover fixed; display:flex; justify-content:center; align-items:flex-start; }
    .quiz-wrap{ width:100vw; min-height:100vh; background:rgba(0,0,0,.78); padding:clamp(12px,2.2vw,20px); color:#fff; box-sizing:border-box; }
    .header{ text-align:center; margin-bottom:10px; }
    .header h1{ margin:0; font-size:24px; color:#fff; background:var(--accent-green); display:inline-block; padding:6px 14px; border-radius:12px; letter-spacing:.02em; }
    .muted{ color:#cbd5e1; font-size:14px; text-align:center; margin:2px 0 8px; }
    .question{ font-size:18px; line-height:1.6; font-weight:bold; margin:4px 0 0; white-space:normal; }
    .qnum{ margin-right:8px; color:#e2e8f0; }
    .gap{ display:inline-block; width:16ch; text-align:center; font-weight:700; }
    .gap.empty{ opacity:.35; }
    .sentence-ja{ min-height:64px; visibility:hidden; margin:4px 0 8px; color:#e2e8f0; font-size:15px; }
    .choices{ list-style:none; padding:0; margin:4px 0 0; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px 14px; }
    .choice-row{ display:grid; grid-template-columns:38px 1fr; gap:10px; align-items:center; }
    .icon-btn{ width:38px; height:38px; border-radius:8px; border:2px solid var(--accent-green); background:#0f172a; color:#e5e7eb; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:18px; }
    .icon-btn:hover{ background:#1f2937; }
    .choice-btn{ width:100%; padding:12px; border:2px solid var(--accent-green); border-radius:8px; background:#1f2937; color:#fff; cursor:pointer; font-size:16px; text-align:left; min-height:48px; }
    .choice-btn:hover{ background:#374151; }
    .correct{ background:#15803d !important; border-color:#22c55e !important; }
    .wrong{ background:#b91c1c !important; border-color:#ef4444 !important; }
    .ja{ display:inline-block; margin-left:8px; color:#cbd5e1; font-size:14px; }
    .actions{ display:flex; justify-content:center; align-items:center; margin-top:4px; min-height:40px; }
    .gold-btn{ padding:12px 18px; font-size:16px; border-radius:10px; background:#000; color:var(--accent-gold); border:1px solid var(--accent-gold); cursor:pointer; font-weight:400; letter-spacing:.2px; }
    .gold-btn:hover{ background:#0a0a0a; }
    .finish-wrap{ display:flex; flex-direction:column; align-items:center; gap:14px; padding:12px; text-align:center; }
    #final-score{ font-size:20px; font-weight:bold; }
    #final-time{ font-size:16px; color:#facc15; }
    #final-msg{ font-size:16px; color:#e2e8f0; max-width:780px; }
    @media (min-width: 1024px){
      .question{ font-size:22px; }
      .sentence-ja{ font-size:18px; min-height:72px; }
      .icon-btn{ width:42px; height:42px; font-size:20px; }
      .choice-btn{ font-size:18px; padding:14px; min-height:54px; }
      .gold-btn{ font-size:18px; padding:14px 22px; }
      .gap{ width: 18ch; }
    }
    @media (max-width: 560px){
      .choices{ grid-template-columns: 1fr; }
      .question{ font-size:16px; }
      .gap{ width: 14ch; }
    }
  `}</style>
);

/* ====== éŸ³ ====== */
function useBeeps(){
  const ctxRef = useRef(null);
  const getCtx = () => ctxRef.current || (ctxRef.current = new (window.AudioContext||window.webkitAudioContext)());
  const beep = (freq,duration=0.14,gain=0.08,type='sine') => {
    const ctx=getCtx(); const o=ctx.createOscillator(); const g=ctx.createGain();
    o.type=type; o.frequency.value=freq; g.gain.value=0.0001; g.connect(ctx.destination); o.connect(g);
    o.start(); g.gain.exponentialRampToValueAtTime(gain, ctx.currentTime+0.01);
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+duration); o.stop(ctx.currentTime+duration+0.02);
  };
  const playCorrect = () => { beep(523.25,0.12); setTimeout(()=>beep(659.25,0.12),110); setTimeout(()=>beep(783.99,0.18),220); };
  const playWrong = () => { const ctx=getCtx(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='triangle'; o.frequency.setValueAtTime(240,ctx.currentTime); o.frequency.linearRampToValueAtTime(170,ctx.currentTime+0.28); g.gain.setValueAtTime(0.15,ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+0.3); o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+0.34); };
  return { playCorrect, playWrong };
}

/* ====== TTS ====== */
function speak(text){
  if(!('speechSynthesis' in window)) return;
  window.speechSynthesis.cancel();
  const u=new SpeechSynthesisUtterance(text);
  const v=window.speechSynthesis.getVoices();
  const en=v.find(x=>/^en(-|_|$)/i.test(x.lang))||v[0];
  if(en) u.voice=en; u.rate=0.95; u.pitch=1;
  window.speechSynthesis.speak(u);
}

/* ====== Set1ï¼ˆæ‰‹æ›¸ã 22å•ï¼‰ ====== */
const SET1 = [
  {q:`Despite the heated debate, the chair maintained perfect ${BLANK_HTML}, speaking calmly and treating both sides fairly.`, a:["equanimity","bravado","parsimony","pomposity"], correct:0, jaChoices:["å¹³é™ã•ï¼ˆå†·é™æ²ˆç€ï¼‰","è™šå‹¢","å€¹ç´„","å°Šå¤§ã•"], jaSentence:"ç™½ç†±ã—ãŸè¨è«–ã®ä¸­ã§ã‚‚ã€è­°é•·ã¯çµ‚å§‹å¹³é™ã•ã‚’ä¿ã¡ã€è½ã¡ç€ã„ã¦ä¸¡è€…ã‚’å…¬å¹³ã«æ‰±ã£ãŸã€‚", id:"Q01"},
  {q:`The committee favored a ${BLANK_HTML} approachâ€”small, testable steps instead of a sweeping overhaul.`, a:["pragmatic","ornate","capricious","derivative"], correct:0, jaChoices:["å®Ÿå‹™çš„ãªï¼ˆå®Ÿç”¨ä¸»ç¾©çš„ãªï¼‰","è£…é£¾çš„ãª","æ°—ã¾ãã‚Œãª","æ¨¡å€£çš„ãª"], jaSentence:"å§”å“¡ä¼šã¯å¤§è¦æ¨¡ãªå…¨é¢æ”¹é©ã§ã¯ãªãã€å°ã•ãæ¤œè¨¼å¯èƒ½ãªæ®µéšã‚’è¸ã‚€å®Ÿå‹™çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ”¯æŒã—ãŸã€‚", id:"Q02"},
  {q:`The CEO issued a rare statement of ${BLANK_HTML}, admitting the rollout had been mishandled.`, a:["contrition","discretion","tenacity","levity"], correct:0, jaChoices:["æ‚”æ¨ï¼ˆåçœï¼‰","æ…é‡ã•","ç²˜ã‚Šå¼·ã•","è»½ç‡ã•"], jaSentence:"CEOã¯ã€å°å…¥ãŒä¸æ‰‹éš›ã ã£ãŸã¨èªã‚ã‚‹ç•°ä¾‹ã®åçœå£°æ˜ã‚’ç™ºè¡¨ã—ãŸã€‚", id:"Q03"},
  {q:`Her explanation sounded convincing at first, but on closer inspection it rested on a ${BLANK_HTML} link between cause and effect.`, a:["tenuous","trenchant","effulgent","docile"], correct:0, jaChoices:["å¸Œè–„ãªï¼ˆè„†å¼±ãªï¼‰","ç—›çƒˆãª","å…‰ã‚Šè¼ã","å¾“é †ãª"], jaSentence:"å½¼å¥³ã®èª¬æ˜ã¯ä¸€è¦‹ã‚‚ã£ã¨ã‚‚ã‚‰ã—ã‹ã£ãŸãŒã€ã‚ˆãèª¿ã¹ã‚‹ã¨å› æœé–¢ä¿‚ãŒå¸Œè–„ãªå‰æã«ç«‹è„šã—ã¦ã„ãŸã€‚", id:"Q04"},
  {q:`Public outrage ${BLANK_HTML} lawmakers into drafting stronger consumer-protection rules within days.`, a:["galvanized","usurped","immolated","capsized"], correct:0, jaChoices:["çªãå‹•ã‹ã—ãŸï¼ˆåˆºæ¿€ã—ãŸï¼‰","ç°’å¥ªã—ãŸ","ç„¼èº«ã—ãŸ","è»¢è¦†ã•ã›ãŸ"], jaSentence:"ä¸–è«–ã®æ€’ã‚ŠãŒè­°å“¡ãŸã¡ã‚’çªãå‹•ã‹ã—ã€æ•°æ—¥ã®ã†ã¡ã«ã‚ˆã‚Šå¼·åŠ›ãªæ¶ˆè²»è€…ä¿è­·è¦å‰‡ã®è‰æ¡ˆä½œæˆã¸ã¨é§†ã‚Šç«‹ã¦ãŸã€‚", id:"Q05"},
  {q:`After reviewing new evidence, the university ${BLANK_HTML} its earlier decision and reinstated the student.`, a:["rescinded","ratified","subsidized","conflated"], correct:0, jaChoices:["æ’¤å›ã—ãŸ","æ‰¿èªã—ãŸ","åŠ©æˆã—ãŸ","æ··åŒã—ãŸ"], jaSentence:"æ–°è¨¼æ‹ ã®æ¤œè¨å¾Œã€å¤§å­¦ã¯ä»¥å‰ã®æ±ºå®šã‚’æ’¤å›ã—ã€ãã®å­¦ç”Ÿã‚’å¾©å­¦ã•ã›ãŸã€‚", id:"Q06"},
  {q:`Cutting the budget now would only ${BLANK_HTML} the problem by delaying essential maintenance.`, a:["exacerbate","ameliorate","quantify","emulate"], correct:0, jaChoices:["æ‚ªåŒ–ã•ã›ã‚‹","æ”¹å–„ã™ã‚‹","æ•°é‡åŒ–ã™ã‚‹","è¦‹ç¿’ã†"], jaSentence:"ä»Šäºˆç®—ã‚’å‰Šæ¸›ã™ã‚‹ã¨ã€å¿…è¦ãªä¿å®ˆã‚’å…ˆå»¶ã°ã—ã«ã™ã‚‹ã“ã¨ã§å•é¡Œã‚’æ‚ªåŒ–ã•ã›ã‚‹ã ã‘ã ã€‚", id:"Q07"},
  {q:`The files were stored in a ${BLANK_HTML} server accessible only to a handful of trusted engineers.`, a:["clandestine","ramshackle","plenary","callous"], correct:0, jaChoices:["ç§˜å¯†ã®ï¼ˆéå…¬é–‹ã®ï¼‰","ãŒãŸãŒãŸã®","å…¨ä½“å‡ºå¸­ã®","å†·æ·¡ãª"], jaSentence:"ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã”ãå°‘æ•°ã®ä¿¡é ¼ã§ãã‚‹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã ã‘ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ç§˜å¯†ã®ã‚µãƒ¼ãƒãƒ¼ã«ä¿ç®¡ã•ã‚Œã¦ã„ãŸã€‚", id:"Q08"},
  {q:`His apology was so ${BLANK_HTML} that the audience felt he was merely going through the motions.`, a:["perfunctory","rhapsodic","didactic","verdant"], correct:0, jaChoices:["ãŠã–ãªã‚Šã®ï¼ˆå½¢ã ã‘ã®ï¼‰","ç†±ç‹‚çš„ãª","æ•™è¨“çš„ãª","é’ã€…ã¨ã—ãŸ"], jaSentence:"å½¼ã®è¬ç½ªã¯ã‚ã¾ã‚Šã«å½¢ã ã‘ã ã£ãŸã®ã§ã€è´è¡†ã¯å˜ã«å„€ç¤¼çš„ã«æ¸ˆã¾ã›ã¦ã„ã‚‹ã¨æ„Ÿã˜ãŸã€‚", id:"Q09"},
  {q:`Negotiators adopted a less ${BLANK_HTML} tone, opening the door to a face-saving compromise.`, a:["belligerent","libertine","diffident","obtuse"], correct:0, jaChoices:["å¥½æˆ¦çš„ãª","æ”¾è•©ã®","é æ…®ãŒã¡ãª","éˆæ„Ÿãª"], jaSentence:"äº¤æ¸‰æ‹…å½“è€…ã¯ã‚ˆã‚Šéå¥½æˆ¦çš„ãªå£èª¿ã«åˆ‡ã‚Šæ›¿ãˆã€é¢å­ã‚’ä¿ã¦ã‚‹å¦¥å”ã®ä½™åœ°ãŒç”Ÿã¾ã‚ŒãŸã€‚", id:"Q10"},
  {q:`Charities stepped in to support families left ${BLANK_HTML} after the factory closure.`, a:["destitute","florid","punctilious","sprightly"], correct:0, jaChoices:["æ¥µè²§ã®","è¯ç¾ãª","å‡ å¸³é¢ãª","æ´»ç™ºãª"], jaSentence:"å·¥å ´é–‰é–ã§æ¥µè²§ã«é™¥ã£ãŸå®¶æ—ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã€æ…ˆå–„å›£ä½“ãŒä»‹å…¥ã—ãŸã€‚", id:"Q11"},
  {q:`To ${BLANK_HTML} the impact of the outage, the company offered free upgrades and extended support hours.`, a:["mitigate","instigate","obfuscate","divest"], correct:0, jaChoices:["ç·©å’Œã™ã‚‹","æ‰‡å‹•ã™ã‚‹","æ›–æ˜§ã«ã™ã‚‹","å£²å´ã™ã‚‹"], jaSentence:"éšœå®³ã®å½±éŸ¿ã‚’ç·©å’Œã™ã‚‹ãŸã‚ã€åŒç¤¾ã¯ç„¡å„Ÿã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¨ã‚µãƒãƒ¼ãƒˆæ™‚é–“ã®å»¶é•·ã‚’æä¾›ã—ãŸã€‚", id:"Q12"},
  {q:`The exhibit ${BLANK_HTML} medieval maps with satellite imagery to highlight how perceptions of space have changed.`, a:["juxtaposed","corrugated","extirpated","consecrated"], correct:0, jaChoices:["ä¸¦ç½®ã—ãŸï¼ˆå¯¾æ¯”ã•ã›ãŸï¼‰","æ³¢çŠ¶ã®","æ ¹çµ¶ã—ãŸ","è–åˆ¥ã—ãŸ"], jaSentence:"å±•ç¤ºã¯ä¸­ä¸–ã®åœ°å›³ã¨è¡›æ˜Ÿç”»åƒã‚’ä¸¦ç½®ã—ã€ç©ºé–“èªè­˜ã®å¤‰åŒ–ã‚’æµ®ãå½«ã‚Šã«ã—ãŸã€‚", id:"Q13"},
  {q:`Her notes were so ${BLANK_HTML} that even months later she could reconstruct every step of the experiment.`, a:["meticulous","profligate","mercurial","jejune"], correct:0, jaChoices:["ç¶¿å¯†ãª","æµªè²»çš„ãª","æ°—ã¾ãã‚Œãª","æœªç†Ÿãªï¼å‘³æ°—ãªã„"], jaSentence:"å½¼å¥³ã®ãƒãƒ¼ãƒˆã¯éå¸¸ã«ç¶¿å¯†ã§ã€æ•°ã‹æœˆå¾Œã§ã‚‚å®Ÿé¨“ã®å…¨å·¥ç¨‹ã‚’å†ç¾ã§ããŸã€‚", id:"Q14"},
  {q:`They conducted a ${BLANK_HTML} review of the contract, making discrete edits without alerting competitors.`, a:["surreptitious","sybaritic","bucolic","hedonic"], correct:0, jaChoices:["å†…å¯†ã®ï¼ˆã“ã£ãã‚Šã—ãŸï¼‰","äº«æ¥½çš„ãª","ç”°åœ’ã®","å¿«æ¥½ä¸»ç¾©ã®"], jaSentence:"å½¼ã‚‰ã¯ç«¶åˆã«æ°—ã¥ã‹ã‚Œãªã„ã‚ˆã†ã€å¥‘ç´„æ›¸ã‚’å†…å¯†ã«è¦‹ç›´ã—ã¦ç‚¹åœ¨ã™ã‚‹ä¿®æ­£ã‚’åŠ ãˆãŸã€‚", id:"Q15"},
  {q:`Expanding too quickly can have unintended ${BLANK_HTML}, such as quality drift and supply bottlenecks.`, a:["ramifications","panaceas","euphemisms","confections"], correct:0, jaChoices:["ï¼ˆå¥½ã¾ã—ããªã„ï¼‰çµæœãƒ»æ³¢åŠåŠ¹æœ","ä¸‡èƒ½è–¬","å©‰æ›²èª","è“å­ï¼ˆå‰µä½œç‰©ï¼‰"], jaSentence:"æ‹¡å¤§ã‚’æ€¥ãã™ãã‚‹ã¨ã€å“è³ªã®é€¸è„±ã‚„ä¾›çµ¦ã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãªã©æœ›ã¾ã—ããªã„æ³¢åŠåŠ¹æœãŒç”Ÿã˜å¾—ã‚‹ã€‚", id:"Q16"},
  {q:`Even after the milestone, her curiosity was ${BLANK_HTML}; she kept probing for a better solution.`, a:["insatiable","amenable","venerable","tractable"], correct:0, jaChoices:["é£½ãã“ã¨ã®ãªã„","å¾“é †ãªï¼å—ã‘å…¥ã‚Œã‚„ã™ã„","å°Šæ•¬ã™ã¹ã","æ‰±ã„ã‚„ã™ã„"], jaSentence:"ç¯€ç›®ã‚’è¿ãˆãŸå¾Œã‚‚å½¼å¥³ã®å¥½å¥‡å¿ƒã¯é£½ãã“ã¨ãªãã€ã‚ˆã‚Šè‰¯ã„è§£æ±ºç­–ã‚’æ¢ã‚Šç¶šã‘ãŸã€‚", id:"Q17"},
  {q:`The study was initially ${BLANK_HTML} by peers, but later replication cemented its reputation.`, a:["disparaged","lionized","canonized","apotheosized"], correct:0, jaChoices:["ã‘ãªã•ã‚ŒãŸ","ç§°è³›ã•ã‚ŒãŸ","æ­£å…¸åŒ–ã•ã‚ŒãŸ","ç¥æ ¼åŒ–ã•ã‚ŒãŸ"], jaSentence:"å½“åˆãã®ç ”ç©¶ã¯åŒåƒšã«ã‘ãªã•ã‚ŒãŸãŒã€å¾Œã®è¿½è©¦ã§è©•ä¾¡ãŒç¢ºå›ºãŸã‚‹ã‚‚ã®ã«ãªã£ãŸã€‚", id:"Q18"},
  {q:`A: Why is everyone stuck on this puzzle?<br>B: Because itâ€™s a genuine ${BLANK_HTML}â€”the data point in two directions at once.`, a:["conundrum","reprieve","catalyst","preamble"], correct:0, jaChoices:["é›£å•ï¼ˆè¬ï¼‰","çŒ¶äºˆ","è§¦åª’","å‰ç½®ã"], jaSentence:"A: ã¿ã‚“ãªãªãœã“ã®ãƒ‘ã‚ºãƒ«ã§è¡Œãè©°ã¾ã£ã¦ã‚‹ã®ï¼Ÿ B: æœ¬ç‰©ã®é›£å•ãªã‚“ã ã€‚ãƒ‡ãƒ¼ã‚¿ãŒåŒæ™‚ã«äºŒã¤ã®æ–¹å‘ã‚’ç¤ºã—ã¦ã„ã‚‹ã‹ã‚‰ã€‚", id:"Q19"},
  {q:`After a long hiatus, she ${BLANK_HTML} on her coding skills and shipped a polished app in two weeks.`, a:["brushed up","dwelled on","petered out","skewed off"], correct:0, jaChoices:["ï¼ˆæŠ€èƒ½ã‚’ï¼‰ç£¨ãç›´ã—ãŸ","ã“ã ã‚ã‚Šç¶šã‘ãŸ","æ¬¡ç¬¬ã«æ¶ˆãˆãŸ","ï¼ˆèª¤ã£ã¦ï¼‰é€¸ã‚ŒãŸ"], jaSentence:"é•·ã„ãƒ–ãƒ©ãƒ³ã‚¯ã®å¾Œã€å½¼å¥³ã¯ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è…•ã‚’ç£¨ãç›´ã—ã€2é€±é–“ã§å®Œæˆåº¦ã®é«˜ã„ã‚¢ãƒ—ãƒªã‚’å‡ºè·ã—ãŸã€‚", id:"Q20"},
  {q:`When the project scope ballooned, the team ${BLANK_HTML} and set stricter boundaries.`, a:["drew the line","played it by ear","let it slide","split hairs"], correct:0, jaChoices:["ä¸€ç·šã‚’å¼•ã„ãŸï¼ˆç·šå¼•ãã—ãŸï¼‰","è‡¨æ©Ÿå¿œå¤‰ã«ã‚„ã£ãŸ","å¤§ç›®ã«è¦‹ãŸ","é‡ç®±ã®éš…ã‚’ã¤ã¤ã„ãŸ"], jaSentence:"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç¯„å›²ãŒè†¨å¼µã—ãŸã¨ãã€ãƒãƒ¼ãƒ ã¯ä¸€ç·šã‚’å¼•ã„ã¦ã‚ˆã‚Šå³æ ¼ãªå¢ƒç•Œã‚’è¨­å®šã—ãŸã€‚", id:"Q21"},
  {q:`Tourists who ignore local advisories often get ${BLANK_HTML} with hefty fines for driving into restricted zones.`, a:["slapped","stumped","coddled","beguiled"], correct:0, jaChoices:["ç§‘ã•ã‚Œã‚‹ï¼ˆä¸æ„ã«ä¸ãˆã‚‰ã‚Œã‚‹ï¼‰","å›°ã‚‰ã›ã‚‰ã‚Œã‚‹","ç”˜ã‚„ã‹ã•ã‚Œã‚‹","ã ã¾ã•ã‚Œã‚‹"], jaSentence:"ç¾åœ°ã®æ³¨æ„å–šèµ·ã‚’ç„¡è¦–ã™ã‚‹è¦³å…‰å®¢ã¯ã€é€²å…¥ç¦æ­¢åŒºåŸŸã«å…¥ã£ã¦é«˜é¡ãªç½°é‡‘ã‚’ç§‘ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚", id:"Q22"}
];

/* ====== Set2ï¼ˆæ‰‹æ›¸ã 22å•ï¼‰ ====== */
const SET2 = [
  {id:"Q01", q:`The timing was purely ${BLANK_HTML}: we met because the train was delayed.`, a:["fortuitous","fictitious","fastidious","felonious"], correct:0, jaChoices:["å¶ç„¶ã®ï¼å¹¸é‹ãª","æ¶ç©ºã®","å‡ å¸³é¢ãªï¼æ½”ç™–ãª","é‡ç½ªã®"], jaSentence:"ãã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ç´”ç²‹ã«å¶ç„¶ã ã£ãŸã€‚é›»è»Šã®é…å»¶ã§å‡ºä¼šã£ãŸã®ã ã€‚"},
  {id:"Q02", q:`An ${BLANK_HTML} malware spread quietly, stealing data for months.`, a:["insidious","insipid","invidious","incisive"], correct:0, jaChoices:["æ½œè¡Œæ€§ã®ï¼é™°æ¹¿ãª","å‘³æ°—ãªã„","åæ„Ÿã‚’è²·ã†","é‹­ã„"], jaSentence:"é™°æ¹¿ãªãƒãƒ«ã‚¦ã‚§ã‚¢ãŒä½•ã‹æœˆã‚‚é™ã‹ã«åºƒã¾ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’ç›—ã¿ç¶šã‘ãŸã€‚"},
  {id:"Q03", q:`The evidence was ${BLANK_HTML}: there was no room for doubt.`, a:["unequivocal","equivocal","ambivalent","provisional"], correct:0, jaChoices:["æ˜ç™½ãªï¼æ›–æ˜§ã•ã®ãªã„","æ›–æ˜§ãª","ç›¸åã™ã‚‹æ„Ÿæƒ…ã®","æš«å®šçš„ãª"], jaSentence:"è¨¼æ‹ ã¯æ˜ç™½ã§ã€ç–‘ã„ã®ä½™åœ°ã¯ãªã‹ã£ãŸã€‚"},
  {id:"Q04", q:`He offered a ${BLANK_HTML} apologyâ€”words without effort or feeling.`, a:["perfunctory","preponderant","pernicious","persnickety"], correct:0, jaChoices:["ãŠã–ãªã‚Šã®","å„ªå‹¢ãª","æœ‰å®³ãª","ç´°ã‹ã„ã“ã¨ã«ã†ã‚‹ã•ã„"], jaSentence:"å½¼ã®è¬ç½ªã¯å½¢ã ã‘ã§ã€å¿ƒãŒã“ã‚‚ã£ã¦ã„ãªã‹ã£ãŸã€‚"},
  {id:"Q05", q:`The protest ${BLANK_HTML} voters who had felt ignored for years.`, a:["galvanized","glamorized","generalized","garnered"], correct:0, jaChoices:["çªãå‹•ã‹ã—ãŸ","è¯ç¾ã«è¦‹ã›ãŸ","ä¸€èˆ¬åŒ–ã—ãŸ","ç²å¾—ã—ãŸ"], jaSentence:"ãã®æŠ—è­°ã¯ã€é•·å¹´ç„¡è¦–ã•ã‚Œã¦ããŸæœ‰æ¨©è€…ã‚’çªãå‹•ã‹ã—ãŸã€‚"},
  {id:"Q06", q:`They tried to ${BLANK_HTML} the embargo by using third-party shippers.`, a:["circumvent","circuit","circumscribe","circularize"], correct:0, jaChoices:["è¿‚å›ã™ã‚‹ï¼æŠœã‘é“ã‚’æ¢ã™","å›è·¯","åˆ¶é™ã™ã‚‹","å›è¦§ã™ã‚‹"], jaSentence:"å½¼ã‚‰ã¯ç¬¬ä¸‰è€…é…é€ã‚’ä½¿ã„ã€ç¦è¼¸ã‚’è¿‚å›ã—ã‚ˆã†ã¨ã—ãŸã€‚"},
  {id:"Q07", q:`Witnesses ${BLANK_HTML} the timeline with photos and receipts.`, a:["corroborated","collaborated","contravened","correlated"], correct:0, jaChoices:["è£ä»˜ã‘ãŸ","å”åƒã—ãŸ","é•åã—ãŸ","ç›¸é–¢ã•ã›ãŸ"], jaSentence:"è¨¼äººãŸã¡ã¯å†™çœŸã¨é ˜åæ›¸ã§æ™‚ç³»åˆ—ã‚’è£ä»˜ã‘ãŸã€‚"},
  {id:"Q08", q:`The contract ${BLANK_HTML} each partyâ€™s duties in plain language.`, a:["delineated","delegated","deliberated","dilated"], correct:0, jaChoices:["æ˜ç¢ºã«ç¤ºã—ãŸ","å§”ä»»ã—ãŸ","ç†Ÿè­°ã—ãŸ","æ‹¡å¼µã—ãŸ"], jaSentence:"å¥‘ç´„ã¯å„å½“äº‹è€…ã®ç¾©å‹™ã‚’å¹³æ˜“ãªè¨€è‘‰ã§æ˜ç¢ºã«ç¤ºã—ã¦ã„ãŸã€‚"},
  {id:"Q09", q:`New policies aim to ${BLANK_HTML} overcrowding by funding clinics.`, a:["ameliorate","abdicate","obfuscate","commiserate"], correct:0, jaChoices:["æ”¹å–„ã™ã‚‹","é€€ä½ã™ã‚‹","æ›–æ˜§ã«ã™ã‚‹","åŒæƒ…ã™ã‚‹"], jaSentence:"æ–°æ”¿ç­–ã¯è¨ºç™‚æ‰€ã¸ã®è³‡é‡‘æä¾›ã§éå¯†ã‚’æ”¹å–„ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã™ã€‚"},
  {id:"Q10", q:`The findings may ${BLANK_HTML} her after months of suspicion.`, a:["vindicate","vitiate","intimidate","validate"], correct:0, jaChoices:["æ½”ç™½ã‚’è¨¼æ˜ã™ã‚‹","æãªã†","è„…ã™","æ¤œè¨¼ã™ã‚‹"], jaSentence:"ãã®çµæœã¯ã€æ•°ã‹æœˆã®ç–‘ã„ã®å¾Œã«å½¼å¥³ã®æ½”ç™½ã‚’è¨¼æ˜ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚"},
  {id:"Q11", q:`The sudden drop in sales was an ${BLANK_HTML}, not a long-term trend.`, a:["aberration","apparition","abjuration","ablation"], correct:0, jaChoices:["ä¾‹å¤–çš„ç¾è±¡","å¹½éœŠãƒ»å‡ºç¾","æ”¾æ£„","åˆ‡é™¤"], jaSentence:"å£²ä¸Šã®æ€¥è½ã¯ä¸€æ™‚çš„ãªä¾‹å¤–ã§ã€é•·æœŸçš„ãªå‚¾å‘ã§ã¯ãªã‹ã£ãŸã€‚"},
  {id:"Q12", q:`His tastes are ${BLANK_HTML}: charmingly odd and personal.`, a:["idiosyncratic","ideographic","idyllic","iconic"], correct:0, jaChoices:["ç‹¬ç‰¹ã®","è¡¨æ„æ–‡å­—ã®","ç‰§æ­Œçš„ãª","è±¡å¾´çš„ãª"], jaSentence:"å½¼ã®è¶£å‘³ã¯ç‹¬ç‰¹ã§ã€ã©ã“ã‹æ„›å¬ŒãŒã‚ã‚‹ã€‚"},
  {id:"Q13", q:`She sounded ${BLANK_HTML}, shrugging off the crisis as nothing.`, a:["nonchalant","nonplussed","nonpareil","nocturnal"], correct:0, jaChoices:["å¹³ç„¶ã¨ã—ãŸ","å½“æƒ‘ã—ãŸ","ç„¡æ¯”ã®","å¤œè¡Œæ€§ã®"], jaSentence:"å½¼å¥³ã¯å±æ©Ÿã‚’ã‚‚ã®ã¨ã‚‚ã›ãšã€å¹³ç„¶ã¨ã—ã¦ã„ã‚‹ã‚ˆã†ã«èã“ãˆãŸã€‚"},
  {id:"Q14", q:`Heâ€™s ${BLANK_HTML}, rejecting any report with a single typo.`, a:["fastidious","facetious","fallacious","fatuous"], correct:0, jaChoices:["æ½”ç™–ãªï¼ç´°éƒ¨ã«ã†ã‚‹ã•ã„","ãµã–ã‘ãŸ","èª¤ã£ãŸè«–ç†ã®","æ„šã‹ãª"], jaSentence:"å½¼ã¯éå¸¸ã«å‡ å¸³é¢ã§ã€èª¤å­—ä¸€ã¤ã§ã‚‚ã‚ã‚‹å ±å‘Šæ›¸ã¯é€€ã‘ã‚‹ã€‚"},
  {id:"Q15", q:`The ${BLANK_HTML} reason for the delay was traffic, but the real cause was budgeting.`, a:["ostensible","austere","ostentatious","obtuse"], correct:0, jaChoices:["è¡¨å‘ãã®","è³ªç´ ãª","ã“ã‚Œè¦‹ã‚ˆãŒã—ã®","éˆã„"], jaSentence:"é…å»¶ã®è¡¨å‘ãã®ç†ç”±ã¯æ¸‹æ»ã ã£ãŸãŒã€å®Ÿéš›ã®åŸå› ã¯äºˆç®—ã ã£ãŸã€‚"},
  {id:"Q16", q:`The threat was ${BLANK_HTML}: never said aloud, but clearly understood.`, a:["implicit","explicit","illicit","inchoate"], correct:0, jaChoices:["æš—é»™ã®","æ˜ç¤ºçš„ãª","ä¸æ³•ã®","æœªå½¢æˆã®"], jaSentence:"ãã®è„…ã—ã¯å£ã«ã•ã‚Œãªã‹ã£ãŸãŒã€æš—é»™ã«ç†è§£ã•ã‚ŒãŸã€‚"},
  {id:"Q17", q:`The lecture felt ${BLANK_HTML}, full of niche terms few knew.`, a:["esoteric","exoteric","eccentric","esurient"], correct:0, jaChoices:["é›£è§£ãªï¼ç§˜æ•™çš„ãª","å¤§è¡†å‘ã‘ã®","é¢¨å¤‰ã‚ã‚Šãª","è²ªæ¬²ãªï¼ˆå¤èªï¼‰"], jaSentence:"ãã®è¬›ç¾©ã¯é›£è§£ã§ã€çŸ¥ã‚‹äººãçŸ¥ã‚‹ç”¨èªã«æº€ã¡ã¦ã„ãŸã€‚"},
  {id:"Q18", q:`The author was ${BLANK_HTML}, publishing three acclaimed novels in two years.`, a:["prolific","profligate","prophetic","prosaic"], correct:0, jaChoices:["å¤šä½œã®","æµªè²»ç™–ã®ã‚ã‚‹","äºˆè¨€çš„ãª","æ•£æ–‡çš„ã§å¹³å‡¡ãª"], jaSentence:"ãã®ä½œå®¶ã¯å¤šä½œã§ã€2å¹´ã§é«˜è©•ä¾¡ã®å°èª¬ã‚’3å†Šå‡ºã—ãŸã€‚"},
  {id:"Q19", q:`He stayed ${BLANK_HTML}, revealing little in the interview.`, a:["reticent","recalcitrant","resonant","retinue"], correct:0, jaChoices:["å£ãŒé‡ã„","åæŠ—çš„ãª","åéŸ¿ã™ã‚‹","éšå“¡"], jaSentence:"å½¼ã¯ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã§å¤šãã‚’èªã‚‰ãšã€å£ãŒé‡ã‹ã£ãŸã€‚"},
  {id:"Q20", q:`Cut any ${BLANK_HTML} features so we can ship a lean MVP.`, a:["superfluous","supercilious","synchronous","subcutaneous"], correct:0, jaChoices:["ä½™åˆ†ãªï¼ä¸è¦ãª","é«˜æ…¢ãª","åŒæœŸã®","çš®ä¸‹ã®"], jaSentence:"ä½™è¨ˆãªæ©Ÿèƒ½ã¯å‰Šã£ã¦ã€è»½é‡ãªMVPã‚’å‡ºè·ã—ã‚ˆã†ã€‚"},
  {id:"Q21", q:`The data will not withstand ${BLANK_HTML}: the sample is too small.`, a:["scrutiny","serendipity","sorcery","scarcity"], correct:0, jaChoices:["ç²¾æŸ»","å¶ç„¶ã®å¹¸é‹","é­”è¡“","ä¸è¶³"], jaSentence:"ãã®ãƒ‡ãƒ¼ã‚¿ã¯ç²¾æŸ»ã«è€ãˆãªã„ã€‚ã‚µãƒ³ãƒ—ãƒ«ãŒå°ã•ã™ãã‚‹ã€‚"},
  {id:"Q22", q:`Their volunteer work was ${BLANK_HTML}, earning praise from all sides.`, a:["laudable","laughable","legible","laudatory"], correct:0, jaChoices:["ç§°è³›ã«å€¤ã™ã‚‹","ç¬‘ã†ã¹ã","åˆ¤èª­å¯èƒ½ãª","ç§°è³›çš„ãªï¼ˆå½¢å®¹ã®æ€§è³ªï¼‰"], jaSentence:"å½¼ã‚‰ã®ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢æ´»å‹•ã¯ç§°è³›ã«å€¤ã—ã€ã‚ã‚‰ã‚†ã‚‹æ–¹é¢ã‹ã‚‰è©•ä¾¡ã•ã‚ŒãŸã€‚"}
];

/* ====== Set3ï¼ˆæ‰‹æ›¸ã 22å•ï¼‰ ====== */
const SET3 = [
  {id:"Q01", q:`Her tone was ${BLANK_HTML}, more intent on teaching than debating.`, a:["didactic","dogmatic","dramatic","didactical"], correct:0, jaChoices:["æ•™è¨“çš„ãª","ç‹¬æ–­çš„ãª","åŠ‡çš„ãª","æ•™è¨“çš„ãªï¼ˆç•°ç¶´ï¼‰"], jaSentence:"å½¼å¥³ã®å£èª¿ã¯æ•™è¨“çš„ã§ã€è­°è«–ã‚ˆã‚Šã‚‚æ•™ãˆã‚‹ã“ã¨ã«é‡ããŒã‚ã£ãŸã€‚"},
  {id:"Q02", q:`A ${BLANK_HTML} approach saved money, but risked underinvesting in talent.`, a:["parsimonious","perspicacious","promiscuous","partisan"], correct:0, jaChoices:["æ¥µåº¦ã«å€¹ç´„çš„ãª","æ´å¯ŸåŠ›ã®ã‚ã‚‹","ä¹±é›‘ãªï¼æ‰‹å½“ãŸã‚Šæ¬¡ç¬¬ã®","å…šæ´¾çš„ãª"], jaSentence:"æ¥µç«¯ã«å€¹ç´„çš„ãªæ–¹é‡ã¯é‡‘ã¯ç¯€ç´„ã—ãŸãŒã€äººææŠ•è³‡ä¸è¶³ã®ãƒªã‚¹ã‚¯ãŒã‚ã£ãŸã€‚"},
  {id:"Q03", q:`The ${BLANK_HTML} claim collapsed once the emails surfaced.`, a:["mendacious","mendicant","monastic","monotonous"], correct:0, jaChoices:["è™šå½ã®","ç‰©ä¹ã„ã®","ä¿®é“å£«ã®","å˜èª¿ãª"], jaSentence:"ãƒ¡ãƒ¼ãƒ«ãŒå‡ºã¦ãã‚‹ã¨ã€ãã®è™šå½ã®ä¸»å¼µã¯å´©ã‚ŒãŸã€‚"},
  {id:"Q04", q:`They remained ${BLANK_HTML}, refusing compromise even after months of talks.`, a:["intransigent","insurgent","intransitive","insensate"], correct:0, jaChoices:["å¼·ç¡¬ãª","åä¹±ã®","è‡ªå‹•è©ã®","ç„¡æ„Ÿè¦šãª"], jaSentence:"å½¼ã‚‰ã¯æ•°ã‹æœˆã®å”è­°ã®å¾Œã§ã‚‚ã€å¦¥å”ã‚’æ‹’ã¿å¼·ç¡¬å§¿å‹¢ã‚’å´©ã•ãªã‹ã£ãŸã€‚"},
  {id:"Q05", q:`New regulations ${BLANK_HTML} fraud by requiring two-factor authentication.`, a:["preclude","prelude","proceed","prefigure"], correct:0, jaChoices:["æ’é™¤ã™ã‚‹ï¼èµ·ã“ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹","å‰å¥","é€²ã‚€","äºˆç¤ºã™ã‚‹"], jaSentence:"æ–°è¦åˆ¶ã¯äºŒè¦ç´ èªè¨¼ã®ç¾©å‹™åŒ–ã«ã‚ˆã‚Šã€ä¸æ­£ã‚’æœªç„¶ã«é˜²ãã€‚"},
  {id:"Q06", q:`Conditions were ${BLANK_HTML}, with clear skies and light winds for launch.`, a:["propitious","propulsive","preposterous","pretentious"], correct:0, jaChoices:["å¥½éƒ½åˆãª","æ¨é€²åŠ›ã®","ã°ã‹ã’ãŸ","æ°—å–ã£ãŸ"], jaSentence:"æ‰“ã¡ä¸Šã’ã«ã¯ã€å¿«æ™´ã¨å¾®é¢¨ã¨ã„ã†å¥½éƒ½åˆãªæ¡ä»¶ã ã£ãŸã€‚"},
  {id:"Q07", q:`The paper is highly ${BLANK_HTML}, but its insights are worth the effort.`, a:["recondite","recalcitrant","redolent","rectilinear"], correct:0, jaChoices:["é›£è§£ãª","åæŠ—çš„ãª","é¦™ã‚Šç«‹ã¤","ç›´ç·šã®"], jaSentence:"ãã®è«–æ–‡ã¯é›£è§£ã ãŒã€å¾—ã‚‰ã‚Œã‚‹æ´å¯Ÿã¯åŠªåŠ›ã«å€¤ã™ã‚‹ã€‚"},
  {id:"Q08", q:`Her ${BLANK_HTML} adviceâ€”measured and wiseâ€”helped steer the project.`, a:["sagacious","sanguine","salacious","salutary"], correct:0, jaChoices:["è³¢æ˜ãª","æ¥½è¦³çš„ãª","ã¿ã ã‚‰ãª","æœ‰ç›Šãª"], jaSentence:"å½¼å¥³ã®è³¢æ˜ãªåŠ©è¨€ãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èˆµå–ã‚Šã«å½¹ç«‹ã£ãŸã€‚"},
  {id:"Q09", q:`The new intern proved highly ${BLANK_HTML}, easily guided on complex tasks.`, a:["tractable","tactile","tenable","tangible"], correct:0, jaChoices:["æ‰±ã„ã‚„ã™ã„","è§¦è¦šã®","ç¶­æŒå¯èƒ½ãª","æœ‰å½¢ã®"], jaSentence:"æ–°ã—ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã¯è¤‡é›‘ãªä»•äº‹ã§ã‚‚æŒ‡ç¤ºã«ã†ã¾ãå¾“ã„ã€æ‰±ã„ã‚„ã™ã‹ã£ãŸã€‚"},
  {id:"Q10", q:`We verified the reportâ€™s ${BLANK_HTML} before citing it publicly.`, a:["veracity","voracity","verity","variety"], correct:0, jaChoices:["çœŸå®Ÿæ€§","å¤§é£Ÿã„","çœŸå®Ÿ","å¤šæ§˜æ€§"], jaSentence:"ãã®å ±å‘Šæ›¸ã‚’å…¬ã«å¼•ç”¨ã™ã‚‹å‰ã«ã€çœŸå®Ÿæ€§ã‚’ç¢ºèªã—ãŸã€‚"},
  {id:"Q11", q:`The plan is still ${BLANK_HTML}, lacking clear milestones or scope.`, a:["nebulous","noxious","nubile","nascent"], correct:0, jaChoices:["æ›–æ˜§ãª","æœ‰å®³ãª","å©šæœŸã®","ç”Ÿã¾ã‚ŒãŸã°ã‹ã‚Šã®"], jaSentence:"ãã®è¨ˆç”»ã¯ä¾ç„¶ã¨ã—ã¦æ›–æ˜§ã§ã€æ˜ç¢ºãªãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã‚„ç¯„å›²ãŒãªã„ã€‚"},
  {id:"Q12", q:`The concert was ${BLANK_HTML}, drawing a crowd from three cities.`, a:["prodigious","promissory","propitiatory","provident"], correct:0, jaChoices:["åœ§å€’çš„ãªï¼ä¸¦å¤–ã‚ŒãŸ","ç´„æŸã®","ãªã ã‚ã‚‹ãŸã‚ã®","å…ˆè¦‹ã®æ˜ã®ã‚ã‚‹"], jaSentence:"ãã®ã‚³ãƒ³ã‚µãƒ¼ãƒˆã¯ä¸¦å¤–ã‚Œã¦ãŠã‚Šã€3éƒ½å¸‚ã‹ã‚‰è¦³å®¢ã‚’å¼•ãå¯„ã›ãŸã€‚"},
  {id:"Q13", q:`His ${BLANK_HTML} flattery made the boss uncomfortable.`, a:["obsequious","oblivious","obstreperous","omnivorous"], correct:0, jaChoices:["ã¸ã¤ã‚‰ã„ã™ãã‚‹","æ°—ã¥ã„ã¦ã„ãªã„","æ‰‹ã«è² ãˆãªã„","é›‘é£Ÿã®"], jaSentence:"å½¼ã®ã¸ã¤ã‚‰ã„ã™ãã‚‹ãŠä¸–è¾ã¯ã€ä¸Šå¸ã‚’å±…å¿ƒåœ°æ‚ªãã•ã›ãŸã€‚"},
  {id:"Q14", q:`In a ${BLANK_HTML} gesture, she praised her rival during the ceremony.`, a:["magnanimous","magisterial","magniloquent","magnetic"], correct:0, jaChoices:["å¯›å¤§ãª","å¨å³ã®ã‚ã‚‹","å¤§ã’ã•ãªè¨€ã„å›ã—ã®","äººã‚’å¼•ãä»˜ã‘ã‚‹"], jaSentence:"å½¼å¥³ã¯å¯›å¤§ã«ã‚‚ã€å¼å…¸ã®æœ€ä¸­ã«ãƒ©ã‚¤ãƒãƒ«ã‚’ç§°ãˆãŸã€‚"},
  {id:"Q15", q:`Heâ€™s ${BLANK_HTML}, following every rule to the letter.`, a:["punctilious","pugnacious","pulchritudinous","putative"], correct:0, jaChoices:["å‡ å¸³é¢ãª","å¥½æˆ¦çš„ãª","ç¾ã—ã„ï¼ˆæ–‡èªï¼‰","æ¨å®šä¸Šã®"], jaSentence:"å½¼ã¯å‡ å¸³é¢ã§ã€ã™ã¹ã¦ã®è¦å‰‡ã‚’ä¸€å­—ä¸€å¥å®ˆã‚‹ã€‚"},
  {id:"Q16", q:`An ${BLANK_HTML} researcher, she hiked alone through the rainforest.`, a:["intrepid","intricate","inertial","internecine"], correct:0, jaChoices:["å‹‡æ•¢ãª","è¤‡é›‘ãª","æ…£æ€§ã®","å†…è¼ªã‚‚ã‚ã®"], jaSentence:"å½¼å¥³ã¯å‹‡æ•¢ãªç ”ç©¶è€…ã§ã€ç†±å¸¯é›¨æ—ã‚’ä¸€äººã§è¸ç ´ã—ãŸã€‚"},
  {id:"Q17", q:`The rumor was ${BLANK_HTML}, invented to discredit the witness.`, a:["spurious","salubrious","speciose","spirited"], correct:0, jaChoices:["æ ¹æ‹ ã®ãªã„ï¼å½ã®","å¥åº·ã«ã‚ˆã„","è¦‹ã‹ã‘å€’ã—ã®","å…ƒæ°—ã®ã‚ˆã„"], jaSentence:"ãã®å™‚ã¯æ ¹æ‹ ãŒãªãã€è¨¼äººã®ä¿¡ç”¨ã‚’è½ã¨ã™ãŸã‚ã«ä½œã‚‰ã‚ŒãŸã‚‚ã®ã ã£ãŸã€‚"},
  {id:"Q18", q:`A naturally ${BLANK_HTML} leader, he spoke only when he had something to add.`, a:["taciturn","tactile","tenacious","talismanic"], correct:0, jaChoices:["å¯¡é»™ãª","è§¦è¦šã®","ç²˜ã‚Šå¼·ã„","ãŠå®ˆã‚Šã®ã‚ˆã†ãª"], jaSentence:"å½¼ã¯ç”Ÿã¾ã‚Œã¤ãå¯¡é»™ãªãƒªãƒ¼ãƒ€ãƒ¼ã§ã€è¨€ã†ã¹ãã“ã¨ãŒã‚ã‚‹æ™‚ã ã‘å£ã‚’é–‹ã„ãŸã€‚"},
  {id:"Q19", q:`She began with surprising ${BLANK_HTML}, ready to take on the new role.`, a:["alacrity","acrimony","allegory","alimony"], correct:0, jaChoices:["æ•é€Ÿã•ï¼æ„æ¬²","è¾›è¾£ã•","å¯“æ„","æ‰¶é¤Šæ‰‹å½“"], jaSentence:"å½¼å¥³ã¯æ–°ã—ã„å½¹å‰²ã«æ„æ¬²æº€ã€…ã§ã€é©šãã»ã©æ•é€Ÿã«å‹•ãå§‹ã‚ãŸã€‚"},
  {id:"Q20", q:`Frustrated by delays, he sounded ${BLANK_HTML}, snapping at minor mistakes.`, a:["petulant","penitent","patrician","pendulous"], correct:0, jaChoices:["ã„ã‚‰ç«‹ã£ãŸï¼çŸ­æ°—ãª","æ‚”ã„æ”¹ã‚ãŸ","è²´æ—ã®","ã¶ã‚‰ä¸‹ãŒã£ãŸ"], jaSentence:"é…å»¶ã«è‹›ç«‹ã£ãŸå½¼ã¯çŸ­æ°—ã«ãªã‚Šã€äº›ç´°ãªãƒŸã‚¹ã«å™›ã¿ã¤ã„ãŸã€‚"},
  {id:"Q21", q:`Trends in fashion are ${BLANK_HTML}, here today and gone tomorrow.`, a:["ephemeral","eleemosynary","epicene","euphonious"], correct:0, jaChoices:["ã¯ã‹ãªã„","æ…ˆå–„ã®","ä¸­æ€§çš„ãª","è€³ã«å¿ƒåœ°ã‚ˆã„"], jaSentence:"ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã®æµè¡Œã¯ã¯ã‹ãªãã€ä»Šæ—¥ã‚ã£ã¦ã‚‚æ˜æ—¥ã«ã¯æ¶ˆãˆã‚‹ã€‚"},
  {id:"Q22", q:`Some outcomes are ${BLANK_HTML}, no matter how hard we resist them.`, a:["ineluctable","ineligible","inflammable","ineffable"], correct:0, jaChoices:["é¿ã‘ãŒãŸã„","è³‡æ ¼ã®ãªã„","å¯ç‡ƒæ€§ã®","è¨€ã„è¡¨ã›ãªã„"], jaSentence:"ã©ã‚“ãªã«æŠ—ã£ã¦ã‚‚ã€é¿ã‘ãŒãŸã„çµæœã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã€‚"}
];

/* ====== Set4ã€œ10: è‡ªå‹•ç”Ÿæˆï¼ˆå“è©ãƒ†ãƒ³ãƒ—ãƒ¬ï¼‹å…¨æ–‡å’Œè¨³ï¼‰ ====== */
/* èªå½™ãƒãƒ³ã‚¯ï¼ˆpos: 'adj' | 'verb'ï¼‰ */
const BANK_POS = [
  // --- adjectives ---
  {en:'pragmatic', ja:'å®Ÿå‹™çš„ãª', pos:'adj'},
  {en:'unequivocal', ja:'æ˜ç™½ãª', pos:'adj'},
  {en:'implicit', ja:'æš—é»™ã®', pos:'adj'},
  {en:'insidious', ja:'é™°æ¹¿ãª', pos:'adj'},
  {en:'fortuitous', ja:'å¶ç„¶ã®', pos:'adj'},
  {en:'nonchalant', ja:'å¹³ç„¶ã¨ã—ãŸ', pos:'adj'},
  {en:'fastidious', ja:'å‡ å¸³é¢ãª', pos:'adj'},
  {en:'ostensible', ja:'è¡¨å‘ãã®', pos:'adj'},
  {en:'esoteric', ja:'é›£è§£ãª', pos:'adj'},
  {en:'prolific', ja:'å¤šä½œã®', pos:'adj'},
  {en:'reticent', ja:'å£ãŒé‡ã„', pos:'adj'},
  {en:'superfluous', ja:'ä½™åˆ†ãª', pos:'adj'},
  {en:'laudable', ja:'ç§°è³›ã«å€¤ã™ã‚‹', pos:'adj'},
  {en:'parsimonious', ja:'æ¥µåº¦ã«å€¹ç´„çš„ãª', pos:'adj'},
  {en:'mendacious', ja:'è™šå½ã®', pos:'adj'},
  {en:'intransigent', ja:'å¼·ç¡¬ãª', pos:'adj'},
  {en:'propitious', ja:'å¥½éƒ½åˆãª', pos:'adj'},
  {en:'recondite', ja:'é›£è§£ãª', pos:'adj'},
  {en:'sagacious', ja:'è³¢æ˜ãª', pos:'adj'},
  {en:'tractable', ja:'æ‰±ã„ã‚„ã™ã„', pos:'adj'},
  {en:'belligerent', ja:'å¥½æˆ¦çš„ãª', pos:'adj'},
  {en:'candid', ja:'ç‡ç›´ãª', pos:'adj'},
  {en:'capricious', ja:'æ°—ã¾ãã‚Œãª', pos:'adj'},
  {en:'clandestine', ja:'ç§˜å¯†ã®', pos:'adj'},
  {en:'decorous', ja:'ç¤¼å„€æ­£ã—ã„', pos:'adj'},
  {en:'deleterious', ja:'æœ‰å®³ãª', pos:'adj'},
  {en:'diffident', ja:'è‡ªä¿¡ã®ãªã„', pos:'adj'},
  {en:'dogmatic', ja:'ç‹¬æ–­çš„ãª', pos:'adj'},
  {en:'ebullient', ja:'ç†±ç‹‚çš„ãª', pos:'adj'},
  {en:'eclectic', ja:'æŠ˜è¡·çš„ãª', pos:'adj'},
  {en:'egregious', ja:'ç›®ã«ä½™ã‚‹', pos:'adj'},
  {en:'eloquent', ja:'é›„å¼ãª', pos:'adj'},
  {en:'elusive', ja:'ã¨ã‚‰ãˆã«ãã„', pos:'adj'},
  {en:'endemic', ja:'å›ºæœ‰ã®', pos:'adj'},
  {en:'erudite', ja:'åšè­˜ã®', pos:'adj'},
  {en:'exigent', ja:'ç·Šæ€¥ã®', pos:'adj'},
  {en:'explicit', ja:'æ˜ç¤ºçš„ãª', pos:'adj'},
  {en:'extraneous', ja:'ç„¡é–¢ä¿‚ã®', pos:'adj'},
  {en:'fervent', ja:'ç†±çƒˆãª', pos:'adj'},
  {en:'flippant', ja:'è»½ç‡ãª', pos:'adj'},
  {en:'furtive', ja:'ã“ãã“ãã—ãŸ', pos:'adj'},
  {en:'gregarious', ja:'ç¤¾äº¤çš„ãª', pos:'adj'},
  {en:'hackneyed', ja:'é™³è…ãª', pos:'adj'},
  {en:'haphazard', ja:'è¡Œãå½“ãŸã‚Šã°ã£ãŸã‚Šã®', pos:'adj'},

  // --- verbs ---
  {en:'ameliorate', ja:'æ”¹å–„ã™ã‚‹', pos:'verb'},
  {en:'corroborate', ja:'è£ä»˜ã‘ã‚‹', pos:'verb'},
  {en:'mitigate', ja:'ç·©å’Œã™ã‚‹', pos:'verb'},
  {en:'exacerbate', ja:'æ‚ªåŒ–ã•ã›ã‚‹', pos:'verb'},
  {en:'preclude', ja:'èµ·ã“ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹', pos:'verb'},
  {en:'delineate', ja:'æ˜ç¢ºã«ç¤ºã™', pos:'verb'},
  {en:'vindicate', ja:'æ½”ç™½ã‚’è¨¼æ˜ã™ã‚‹', pos:'verb'},
  {en:'circumvent', ja:'è¿‚å›ã™ã‚‹', pos:'verb'},
  {en:'alleviate', ja:'è»½æ¸›ã™ã‚‹', pos:'verb'},
  {en:'engender', ja:'ç”Ÿã¿å‡ºã™', pos:'verb'},
  {en:'expedite', ja:'è¿…é€Ÿã«é€²ã‚ã‚‹', pos:'verb'},
  {en:'conciliate', ja:'å’Œè§£ã•ã›ã‚‹', pos:'verb'},
  {en:'elucidate', ja:'æ˜ã‚‰ã‹ã«ã™ã‚‹', pos:'verb'},
  {en:'eschew', ja:'é¿ã‘ã‚‹', pos:'verb'},
  {en:'extol', ja:'ç§°è³›ã™ã‚‹', pos:'verb'},
  {en:'facilitate', ja:'å®¹æ˜“ã«ã™ã‚‹', pos:'verb'},
  {en:'garner', ja:'ç²å¾—ã™ã‚‹', pos:'verb'},
  {en:'galvanize', ja:'çªãå‹•ã‹ã™', pos:'verb'}
];

/* æ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ï¼ˆè‹±/å’Œï¼‰â€” posåˆ¥ã€‚jaSentence ã¯ã€Œæ–‡ã®å’Œè¨³ã€ã€‚ */
const TEMPLATES_POS = [
  // adj
  {pos:'adj', en:(w)=>`The committee chose a ${BLANK_HTML} solution after weeks of debate.`,
            ja:(ja)=>`æ•°é€±é–“ã®è­°è«–ã®æœ«ã€å§”å“¡ä¼šã¯${ja}è§£æ±ºç­–ã‚’é¸ã‚“ã ã€‚`},
  {pos:'adj', en:(w)=>`Her remarks were refreshingly ${BLANK_HTML} compared to the usual spin.`,
            ja:(ja)=>`å¸¸å¥—å¥ã ã‚‰ã‘ã®å ´ã¨æ¯”ã¹ã€å½¼å¥³ã®ç™ºè¨€ã¯é©šãã»ã©${ja}ã ã£ãŸã€‚`},
  {pos:'adj', en:(w)=>`Negotiators adopted a(n) ${BLANK_HTML} tone and reopened talks.`,
            ja:(ja)=>`äº¤æ¸‰æ‹…å½“è€…ã¯${ja}å£èª¿ã«åˆ‡ã‚Šæ›¿ãˆã€å”è­°ã‚’å†é–‹ã—ãŸã€‚`},
  {pos:'adj', en:(w)=>`Policies must be ${BLANK_HTML} to work in practice.`,
            ja:(ja)=>`æ–¹é‡ã¯å®Ÿå‹™ã§æ©Ÿèƒ½ã™ã‚‹ã‚ˆã†${ja}ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚`},
  {pos:'adj', en:(w)=>`The report was clear and ${BLANK_HTML} throughout.`,
            ja:(ja)=>`ãã®å ±å‘Šæ›¸ã¯çµ‚å§‹æ˜ç¢ºã§${ja}ã ã£ãŸã€‚`},

  // verb
  {pos:'verb', en:(w)=>`Engineers acted quickly to ${BLANK_HTML} the outageâ€™s impact.`,
             ja:(ja)=>`æŠ€è¡“è€…ãŸã¡ã¯éšœå®³ã®å½±éŸ¿ã‚’${ja}ãŸã‚ã«è¿…é€Ÿã«å‹•ã„ãŸã€‚`},
  {pos:'verb', en:(w)=>`Data from multiple trials ${BLANK_HTML} the findings.`,
             ja:(ja)=>`è¤‡æ•°ã®è©¦é¨“ãƒ‡ãƒ¼ã‚¿ãŒçµæœã‚’${ja}ã€‚`},
  {pos:'verb', en:(w)=>`Leaders promised to ${BLANK_HTML} tensions after the leak.`,
             ja:(ja)=>`æµå‡ºå¾Œã€æŒ‡å°éƒ¨ã¯ç·Šå¼µã‚’${ja}ã¨ç´„æŸã—ãŸã€‚`},
  {pos:'verb', en:(w)=>`Clear diagrams helped ${BLANK_HTML} the mechanism.`,
             ja:(ja)=>`æ˜å¿«ãªå›³è§£ãŒä»•çµ„ã¿ã‚’${ja}ã®ã«å½¹ç«‹ã£ãŸã€‚`},
  {pos:'verb', en:(w)=>`Extra funds will ${BLANK_HTML} the investigation.`,
             ja:(ja)=>`è¿½åŠ ã®è³‡é‡‘ã§èª¿æŸ»ã‚’${ja}ã“ã¨ãŒã§ãã‚‹ã€‚`}
];

/* å®‰å®šä¹±æ•° */
function mulberry32(a){ return function(){ let t = a += 0x6D2B79F5; t = Math.imul(t ^ t>>>15, t | 1); t ^= t + Math.imul(t ^ t>>>7, t | 61); return ((t ^ t>>>14) >>> 0) / 4294967296; } }
const pickByPos = (pos) => BANK_POS.filter(x=>x.pos===pos);

function buildGeneratedSetPOS(setNum, seed){
  const rnd = mulberry32(seed);
  const out = [];
  for(let i=0;i<22;i++){
    const tpl = TEMPLATES_POS[Math.floor(rnd()*TEMPLATES_POS.length)];
    const pool = pickByPos(tpl.pos);
    const correct = pool[Math.floor(rnd()*pool.length)];

    // åŒPOSã®ãƒ€ãƒŸãƒ¼3ã¤
    const dSet = new Set();
    while(dSet.size<3){ const d = pool[Math.floor(rnd()*pool.length)]; if(d.en!==correct.en) dSet.add(d.en); }
    const ds = Array.from(dSet).map(en=> pool.find(p=>p.en===en));

    const a = [correct.en, ds[0].en, ds[1].en, ds[2].en];
    const jaChoices = [correct.ja, ds[0].ja, ds[1].ja, ds[2].ja];

    out.push({
      id: `S${setNum}Q${String(i+1).padStart(2,'0')}`,
      qNum: i+1,
      q: tpl.en(correct.en),
      a,
      correct: 0,
      jaChoices,
      jaSentence: tpl.ja(correct.ja)
    });
  }
  return out;
}

const SET4  = buildGeneratedSetPOS(4,  4004);
const SET5  = buildGeneratedSetPOS(5,  5005);
const SET6  = buildGeneratedSetPOS(6,  6006);
const SET7  = buildGeneratedSetPOS(7,  7007);
const SET8  = buildGeneratedSetPOS(8,  8008);
const SET9  = buildGeneratedSetPOS(9,  9009);
const SET10 = buildGeneratedSetPOS(10, 10010);

/* ====== ã‚»ãƒƒãƒˆè¾æ›¸ ====== */
const SETS = { set1: SET1, set2: SET2, set3: SET3, set4: SET4, set5: SET5, set6: SET6, set7: SET7, set8: SET8, set9: SET9, set10: SET10 };

/* ====== Home ====== */
function Home({ onPickSet, onPickReview }){
  // REVIEWã‚«ã‚¦ãƒ³ã‚¿ã¯æ¯å›è¨ˆç®—ï¼ˆæˆ»ã£ãŸç›´å¾Œã‚‚æœ€æ–°è¡¨ç¤ºï¼‰
  const wrongCount = Array.from(loadWrong()).length;
  return (
    <div className="quiz-wrap">
      <div className="header"><h1>è‹±æ¤œï¼‘ç´šèªå½™å•é¡Œ â€” Home</h1></div>
      <div className="muted">Choose a set (22 questions each) or REVIEW your saved wrong answers.</div>
      <div style={{display:'grid', gridTemplateColumns:'repeat(auto-fit,minmax(160px,1fr))', gap:10}}>
        {Array.from({length:10}).map((_,i)=> (
          <button key={i} className="gold-btn" onClick={()=>onPickSet(`set${i+1}`)}>Set {i+1}</button>
        ))}
        <button className="gold-btn" onClick={onPickReview}>REVIEW ({wrongCount})</button>
      </div>
      <div className="finish-wrap" style={{alignItems:'flex-start'}}>
        <button className="gold-btn" onClick={()=>{
          const n = Array.from(loadWrong()).length;
          if(!n) return alert('No saved wrong answers.');
          if(confirm(`Clear ${n} saved wrong items?`)){ clearWrong(); location.reload(); }
        }}>Clear REVIEW history</button>
      </div>
    </div>
  );
}

/* ====== ã‚¯ã‚¤ã‚º ====== */
function Quiz({ setKey, onHome }){
  const data = useMemo(() => (setKey==='review' ? buildReview() : SETS[setKey]), [setKey]);
  const [idx,setIdx] = useState(0);
  const [start,setStart] = useState(0);
  const [score,setScore] = useState(0);
  const [finished,setFinished] = useState(false);
  const [shuffled,setShuffled] = useState([]);
  const [answered,setAnswered] = useState(false);
  const [picked,setPicked] = useState(null);
  const { playCorrect, playWrong } = useBeeps();

  useEffect(()=>{ setStart(Date.now()); },[]);

  useEffect(()=>{
    if(!data || !data.length) return;
    const q = data[idx];
    const withMeta = shuffle(q.a.map((t,i)=>({ text:t, ok:i===q.correct, ja:q.jaChoices[i] })));
    setShuffled(withMeta);
    setAnswered(false); setPicked(null);
    // ç¿»è¨³ã®ãƒªã‚»ãƒƒãƒˆ
    const slot = document.getElementById('ja-slot');
    if (slot) { slot.style.visibility = 'hidden'; slot.textContent = ''; }
  },[idx, data]);

  if(!data || data.length===0){
    return (
      <div className="quiz-wrap">
        <div className="header" style={{display:'flex',justifyContent:'space-between',alignItems:'center',gap:8}}>
          <h1>REVIEW</h1>
          <button className="gold-btn" onClick={onHome}>Home</button>
        </div>
        <div className="muted">No saved wrong answers. Try a set first.</div>
      </div>
    );
  }

  const q = data[idx];
  const n = idx+1;

  const handlePick = (i) => {
    if(answered) return;
    setPicked(i); setAnswered(true);
    const isCorrect = shuffled[i].ok;
    const tag = `${setKey}:${q.id}`;
    if(isCorrect){ setScore(s=>s+1); removeWrong(tag); playCorrect(); }
    else { addWrong(tag); playWrong(); }

    // ç©ºæ‰€ã¸æ­£ç­”ã‚’åŸ‹ã‚ã‚‹
    const gapEl = document.querySelector('.question .gap');
    if(gapEl){ const correctText = q.a[q.correct]; gapEl.textContent = correctText; gapEl.classList.remove('empty'); }

    // æ—¥æœ¬èªã®æ–‡ã‚’è¡¨ç¤º
    const js = document.getElementById('ja-slot'); if(js){ js.style.visibility='visible'; js.textContent = q.jaSentence; }
  };

  const next = () => { if(n===data.length){ setFinished(true); } else { setIdx(i=>i+1); } };

  return (
    <div className="quiz-wrap">
      <div className="header" style={{display:'flex',justifyContent:'space-between',alignItems:'center',gap:8}}>
        <h1>{setKey==='review' ? 'REVIEW' : `Set ${setKey.replace('set','')}`}</h1>
        <button className="gold-btn" onClick={onHome}>Home</button>
      </div>

      {!finished ? (
        <div>
          <div className="muted">Question {n} of {data.length}</div>
          <div className="question">
            <span className="qnum">({n})</span>
            <span dangerouslySetInnerHTML={{__html:q.q}}/>
          </div>
          <div className="sentence-ja" id="ja-slot"></div>

          <ul className="choices">
            {shuffled.map((c,i)=>{
              const isSel = picked===i;
              const isCorrect = answered && c.ok;
              const isWrong = answered && isSel && !c.ok;
              return (
                <li key={i}>
                  <div className="choice-row">
                    <button className="icon-btn" onClick={(e)=>{ e.stopPropagation(); speak(c.text); }} aria-label={`Speak ${c.text}`}>ğŸ”ˆ</button>
                    <button
                      className={`choice-btn ${isCorrect? 'correct':''} ${isWrong? 'wrong':''}`}
                      onClick={()=>handlePick(i)}
                      disabled={answered}
                    >
                      {`${i+1}. ${c.text}`} {answered && <span className="ja"> {c.ja}</span>}
                    </button>
                  </div>
                </li>
              );
            })}
          </ul>

          <div className="actions">
            <button className="gold-btn" style={{visibility: answered? 'visible':'hidden'}} onClick={next}>Next</button>
          </div>
        </div>
      ) : (
        <Results total={data.length} score={score} elapsed={Date.now()-start} onReplay={()=>{ setIdx(0); setScore(0); setFinished(false); setStart(Date.now()); }} onHome={onHome} />
      )}
    </div>
  );
}

/* ====== çµæœç”»é¢ ====== */
function Results({ total, score, elapsed, onReplay, onHome }){
  const perfect = score===total;
  return (
    <div className="finish-wrap">
      <div id="final-score">{perfect? '': `You scored ${score} out of ${total}!`}</div>
      <div id="final-time">Time: {formatTime(elapsed)}</div>
      <div id="final-msg">{perfect ? <>ğŸ† Perfect! ã™ã°ã‚‰ã—ã„ï¼<br/>å…¨å•æ­£è§£ã§ã—ãŸã€‚å®Ÿæˆ¦ã§ã‚‚ãã®èª¿å­ã§ï¼</> : 'Thanks for playing, and please subscribe to my YouTube channel for future updates!'}</div>
      <a href="https://www.youtube.com/@eigophile" target="_blank" rel="noreferrer"><button className="gold-btn">My YouTube Channel</button></a>
      <button className="gold-btn" onClick={onReplay}>Play Again</button>
      <button className="gold-btn" onClick={onHome}>Home</button>
    </div>
  );
}

/* ====== REVIEWå•é¡Œã®æ§‹ç¯‰ ====== */
function buildReview(){
  const tags = Array.from(loadWrong());
  const out = [];
  for(const tag of tags){
    const [setKey,qid] = tag.split(":");
    const arr = SETS[setKey];
    if(!arr) continue;
    const found = arr.find(x=>x.id===qid);
    if(found) out.push(found);
  }
  return out;
}

/* ====== ã‚¢ãƒ—ãƒª ====== */
export default function App(){
  const [mode,setMode] = useState('home');
  const [current,setCurrent] = useState(null);
  const openSet = (k) => { setCurrent(k); setMode('quiz'); };
  return (
    <div className="app-bg">
      <GlobalStyle/>
      {mode==='home' ? (
        <Home
          onPickSet={openSet}
          onPickReview={()=>{
            const qs = buildReview();
            if(qs.length===0){
              alert('No saved wrong answers yet. Do a set first!');
            } else {
              openSet('review');
            }
          }}
        />
      ) : (
        <Quiz key={current} setKey={current} onHome={()=>{ setMode('home'); setCurrent(null); }}/>
      )}
    </div>
  );
}
